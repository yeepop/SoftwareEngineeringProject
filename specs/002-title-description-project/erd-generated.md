%% ERD generated from schema.prisma
%% Do not edit this file directly — regenerate from schema.prisma if needed

# Entity-Relationship Diagram (generated)

The Mermaid ER diagram below was generated from `schema.prisma`. It shows models, primary keys (PK), foreign keys (FK) where obvious, and basic types. Enums are listed after the diagram.

```mermaid
erDiagram
    %% Models
    USER {
      STRING id PK
      STRING email UNIQUE
      STRING username
      STRING phoneNumber
      STRING firstName
      STRING lastName
      STRING role
      BOOLEAN verified
      STRING primaryShelterId
      STRING profilePhotoUrl
      JSON settings
      DATETIME createdAt
      DATETIME updatedAt
      DATETIME deletedAt
    }

    SHELTER {
      STRING id PK
      STRING name
      STRING slug UNIQUE
      STRING contactEmail
      STRING contactPhone
      JSON address
      BOOLEAN verified
      STRING primaryAccountUserId
      JSON metadata
      DATETIME createdAt
      DATETIME updatedAt
      DATETIME deletedAt
    }

    ANIMAL {
      STRING id PK
      STRING name
      STRING species
      STRING breed
      STRING sex
      DATETIME dob
      STRING description
      STRING status
      STRING shelterId
      STRING ownerId
      STRING medicalSummary
      STRING createdBy
      DATETIME createdAt
      DATETIME updatedAt
      DATETIME deletedAt
    }

    ANIMALIMAGE {
      STRING id PK
      STRING animalId FK
      STRING storageKey
      STRING url
      STRING mimeType
      INT width
      INT height
      INT order
      DATETIME createdAt
    }

    APPLICATION {
      STRING id PK
      STRING applicantId FK
      STRING animalId FK
      STRING type
      STRING status
      DATETIME submittedAt
      DATETIME reviewedAt
      STRING reviewNotes
      STRING assigneeId FK
      INT version
      STRING idempotencyKey
      JSON attachments
      DATETIME createdAt
      DATETIME updatedAt
      DATETIME deletedAt
    }

    MEDICALRECORD {
      STRING id PK
      STRING animalId FK
      STRING recordType
      DATETIME date
      STRING provider
      STRING details
      JSON attachments
      BOOLEAN verified
      STRING verifiedBy
      STRING createdBy
      DATETIME createdAt
      DATETIME updatedAt
      DATETIME deletedAt
    }

    ATTACHMENT {
      STRING id PK
      STRING ownerType
      STRING ownerId
      STRING storageKey
      STRING url
      STRING filename
      STRING mimeType
      INT size
      STRING createdBy
      DATETIME createdAt
      DATETIME deletedAt
    }

    NOTIFICATION {
      STRING id PK
      STRING recipientId FK
      STRING actorId
      STRING type
      JSON payload
      BOOLEAN read
      DATETIME createdAt
      DATETIME deliveredAt
      STRING externalDeliveryStatus
      INT retryCount
      STRING lastError
    }

    JOB {
      STRING id PK
      STRING type
      STRING status
      JSON payload
      JSON resultSummary
      STRING createdBy
      DATETIME createdAt
      DATETIME startedAt
      DATETIME finishedAt
      INT attempts
    }

    AUDITLOG {
      STRING id PK
      STRING actorId
      STRING action
      STRING targetType
      STRING targetId
      JSON before
      JSON after
      STRING notes
      DATETIME timestamp
      STRING shelterId
    }

    %% Relationships (one-to-many where appropriate)
    USER ||--o{ APPLICATION : "applicant_applications"
    USER ||--o{ APPLICATION : "assignee_applications"
    USER ||--o{ ANIMAL : "owner_animals"
    USER ||--o{ MEDICALRECORD : "creator_records"
    USER ||--o{ MEDICALRECORD : "verifier_records"
    USER ||--o{ NOTIFICATION : "recipient_notifications"
    USER ||--o{ JOB : "jobs_created"
    USER ||--o{ AUDITLOG : "actor_auditlogs"

    SHELTER ||--o{ ANIMAL : "animals"
    SHELTER ||--o{ AUDITLOG : "shelter_auditlogs"

    ANIMAL ||--o{ ANIMALIMAGE : "images"
    ANIMAL ||--o{ MEDICALRECORD : "medical_records"
    ANIMAL ||--o{ APPLICATION : "applications"

    %% NOTE: ATTACHMENT is a generic owner-typed table (ownerType + ownerId) — not a strict FK in Prisma schema

```

## Enums

- Role: GENERAL_MEMBER, SHELTER_MEMBER, ADMIN
- Species: CAT, DOG
- Sex: MALE, FEMALE, UNKNOWN
- AnimalStatus: DRAFT, SUBMITTED, PUBLISHED, RETIRED
- ApplicationType: ADOPTION, REHOME
- ApplicationStatus: PENDING, UNDER_REVIEW, APPROVED, REJECTED, WITHDRAWN
- MedicalRecordType: TREATMENT, CHECKUP, VACCINE, SURGERY, OTHER
- ExternalDeliveryStatus: NOT_APPLICABLE, PENDING, SENT, FAILED
- JobStatus: PENDING, RUNNING, SUCCEEDED, FAILED

## Notes

- Fields marked `PK` are primary keys. Fields with `FK` are foreign-key columns in the Prisma schema (referencing the named model).
- `Attachment` in the Prisma schema is implemented as a polymorphic generic owner (ownerType/ownerId) and therefore is shown as a standalone entity.
- This file was generated to provide a simple Mermaid erDiagram view. For PlantUML / Chen notation or alternative styling, generate separate files.
