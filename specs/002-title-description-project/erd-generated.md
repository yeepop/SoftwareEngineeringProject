%% ERD generated from schema.prisma
%% Do not edit this file directly — regenerate from schema.prisma if needed

# Entity-Relationship Diagram (generated)

The Mermaid ER diagram below was generated from `schema.prisma`. It shows models, primary keys (PK), foreign keys (FK) where obvious, and basic types. Enums are listed after the diagram.

```mermaid
erDiagram
    %% Models
    USER {
      String id %% PK
      String email %% UNIQUE
      String username
      String phoneNumber
      String firstName
      String lastName
      String role
      Boolean verified
      String primaryShelterId
      String profilePhotoUrl
      String settings %% JSON
      Date createdAt
      Date updatedAt
      Date deletedAt
    }

    SHELTER {
      String id %% PK
      String name
      String slug %% UNIQUE
      String contactEmail
      String contactPhone
      String address %% JSON
      Boolean verified
      String primaryAccountUserId
      String metadata %% JSON
      Date createdAt
      Date updatedAt
      Date deletedAt
    }

    ANIMAL {
      String id %% PK
      String name
      String species
      String breed
      String sex
      Date dob
      String description
      String status
      String shelterId %% FK
      String ownerId %% FK
      String medicalSummary
      String createdBy
      Date createdAt
      Date updatedAt
      Date deletedAt
    }

    ANIMALIMAGE {
      String id %% PK
      String animalId %% FK
      String storageKey
      String url
      String mimeType
      Int width
      Int height
      Int order
      Date createdAt
    }

    APPLICATION {
      String id %% PK
      String applicantId %% FK
      String animalId %% FK
      String type
      String status
      Date submittedAt
      Date reviewedAt
      String reviewNotes
      String assigneeId %% FK
      Int version
      String idempotencyKey
      String attachments %% JSON
      Date createdAt
      Date updatedAt
      Date deletedAt
    }

    MEDICALRECORD {
      String id %% PK
      String animalId %% FK
      String recordType
      Date date
      String provider
      String details
      String attachments %% JSON
      Boolean verified
      String verifiedBy %% FK
      String createdBy %% FK
      Date createdAt
      Date updatedAt
      Date deletedAt
    }

    ATTACHMENT {
      String id %% PK
      String ownerType
      String ownerId %% Generic FK
      String storageKey
      String url
      String filename
      String mimeType
      Int size
      String createdBy %% FK
      Date createdAt
      Date deletedAt
    }

    NOTIFICATION {
      String id %% PK
      String recipientId %% FK
      String actorId %% FK
      String type
      String payload %% JSON
      Boolean read
      Date createdAt
      Date deliveredAt
      String externalDeliveryStatus
      Int retryCount
      String lastError
    }

    JOB {
      String id %% PK
      String type
      String status
      String payload %% JSON
      String resultSummary %% JSON
      String createdBy %% FK
      Date createdAt
      Date startedAt
      Date finishedAt
      Int attempts
    }

    AUDITLOG {
      String id %% PK
      String actorId %% FK
      String action
      String targetType
      String targetId
      String before %% JSON
      String after %% JSON
      String notes
      Date timestamp
      String shelterId %% FK
    }

    %% Relationships
    USER ||--o{ APPLICATION : "applicant_applications"
    USER ||--o{ APPLICATION : "assignee_applications"
    USER ||--o{ ANIMAL : "owner_animals"
    USER ||--o{ MEDICALRECORD : "creator_records"
    USER ||--o{ MEDICALRECORD : "verifier_records"
    USER ||--o{ NOTIFICATION : "recipient_notifications"
    USER ||--o{ JOB : "jobs_created"
    USER ||--o{ AUDITLOG : "actor_auditlogs"

    SHELTER ||--o{ ANIMAL : "animals"
    SHELTER ||--o{ AUDITLOG : "shelter_auditlogs"

    ANIMAL ||--o{ ANIMALIMAGE : "images"
    ANIMAL ||--o{ MEDICALRECORD : "medical_records"
    ANIMAL ||--o{ APPLICATION : "applications"


    %% NOTE: ATTACHMENT is a generic owner-typed table (ownerType + ownerId) — not a strict FK in Prisma schema

```

## Enums

- Role: GENERAL_MEMBER, SHELTER_MEMBER, ADMIN
- Species: CAT, DOG
- Sex: MALE, FEMALE, UNKNOWN
- AnimalStatus: DRAFT, SUBMITTED, PUBLISHED, RETIRED
- ApplicationType: ADOPTION, REHOME
- ApplicationStatus: PENDING, UNDER_REVIEW, APPROVED, REJECTED, WITHDRAWN
- MedicalRecordType: TREATMENT, CHECKUP, VACCINE, SURGERY, OTHER
- ExternalDeliveryStatus: NOT_APPLICABLE, PENDING, SENT, FAILED
- JobStatus: PENDING, RUNNING, SUCCEEDED, FAILED

## Notes

- Fields marked `PK` are primary keys. Fields with `FK` are foreign-key columns in the Prisma schema (referencing the named model).
- `Attachment` in the Prisma schema is implemented as a polymorphic generic owner (ownerType/ownerId) and therefore is shown as a standalone entity.
- This file was generated to provide a simple Mermaid erDiagram view. For PlantUML / Chen notation or alternative styling, generate separate files.
